# Network Packet Sniffer with Alert System

## 📋 Project Overview

A real-time network traffic sniffer with anomaly detection capabilities built using Python and Scapy. This tool captures network packets, analyzes headers, detects suspicious activities, logs data to SQLite database, and sends alerts when thresholds are breached.

## 🎯 Objective

Build a comprehensive network security monitoring tool that can:
- Capture and analyze network packets in real-time
- Detect various network anomalies (port scanning, SYN floods, packet flooding)
- Store traffic data persistently in SQLite database
- Generate alerts via email and log files
- Visualize network traffic patterns

## ✨ Features

- **Real-time Packet Capture**: Sniff packets from network interfaces using Scapy
- **Header Analysis**: Extract and analyze IP, TCP, UDP, ICMP headers
- **Anomaly Detection**: 
  - Port scanning detection
  - SYN flood attack detection
  - Packet flooding detection
  - Oversized packet detection
- **Database Logging**: Persistent storage using SQLite
- **Alert System**: Email notifications and log file alerts
- **Traffic Visualization**: Optional GUI with live traffic graphs
- **Traffic Summary**: Protocol distribution and top talkers statistics

## 🛠️ Technologies Used

- **Python 3.8+**: Core programming language
- **Scapy**: Packet manipulation and sniffing
- **SQLite3**: Database for packet and alert storage
- **smtplib**: Email alert functionality
- **matplotlib**: Data visualization
- **tkinter**: Optional GUI interface

## 📁 Project Structure

```
network-packet-sniffer/
│
├── src/
│   ├── packet_sniffer.py      # Main sniffer application
│   ├── database.py             # Database handler
│   ├── anomaly_detector.py     # Anomaly detection logic
│   ├── alert_system.py         # Email alert system
│   └── gui.py                  # Optional GUI
│
├── config/
│   └── config.json             # Configuration file
│
├── data/
│   ├── network_traffic.db      # SQLite database (generated)
│   └── alerts.log              # Alert log file (generated)
│
├── docs/
│   ├── project_report.pdf      # Project documentation
│   └── screenshots/            # Application screenshots
│
├── tests/
│   └── test_sniffer.py         # Unit tests
│
├── requirements.txt            # Python dependencies
├── README.md                   # This file
└── LICENSE                     # MIT License
```

## 🚀 Installation

### Prerequisites
- Python 3.8 or higher
- Administrator/root privileges (required for packet sniffing)
- Linux/macOS/Windows with WinPcap or Npcap

### Setup

1. **Clone the repository**
```bash
git clone https://github.com/yourusername/network-packet-sniffer.git
cd network-packet-sniffer
```

2. **Create virtual environment (recommended)**
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

3. **Install dependencies**
```bash
pip install -r requirements.txt
```

4. **Configure settings**
Edit `config/config.json` to set your preferences:
- Network interface
- Detection thresholds
- Email alert settings

## 💻 Usage

### Command Line Interface

**Basic usage:**
```bash
sudo python src/packet_sniffer.py
```

**Specify interface:**
```bash
sudo python src/packet_sniffer.py --interface eth0
```

**Capture specific number of packets:**
```bash
sudo python src/packet_sniffer.py --count 1000
```

### GUI Mode

```bash
sudo python src/gui.py
```

### View Statistics

```bash
python src/analyze_traffic.py
```

## 🔍 Anomaly Detection

The system detects the following anomalies:

### 1. Port Scanning
- **Detection Method**: Tracks unique destination ports per source IP
- **Threshold**: >50 ports in 60 seconds
- **Severity**: HIGH

### 2. SYN Flood Attack
- **Detection Method**: Monitors SYN packets without corresponding ACK
- **Threshold**: >100 SYN packets from same source
- **Severity**: CRITICAL

### 3. Packet Flooding
- **Detection Method**: Calculates packet rate per source IP
- **Threshold**: >500 packets per second
- **Severity**: HIGH

### 4. Oversized Packets
- **Detection Method**: Checks packet size against MTU
- **Threshold**: >1500 bytes
- **Severity**: MEDIUM

## 📊 Database Schema

### Packets Table
```sql
CREATE TABLE packets (
    id INTEGER PRIMARY KEY,
    timestamp TEXT,
    src_ip TEXT,
    dst_ip TEXT,
    src_port INTEGER,
    dst_port INTEGER,
    protocol TEXT,
    packet_size INTEGER,
    tcp_flags TEXT,
    payload_preview TEXT
);
```

### Alerts Table
```sql
CREATE TABLE alerts (
    id INTEGER PRIMARY KEY,
    timestamp TEXT,
    alert_type TEXT,
    source_ip TEXT,
    description TEXT,
    severity TEXT
);
```

## 📧 Email Alerts

Configure email alerts in `config/config.json`:

```json
{
    "email": {
        "smtp_server": "smtp.gmail.com",
        "smtp_port": 587,
        "sender_email": "your_email@gmail.com",
        "sender_password": "your_app_password",
        "recipient_email": "security_team@company.com"
    }
}
```

**Note**: For Gmail, use App Passwords instead of regular password.

## 📈 Visualization

The tool provides traffic visualization through:
- Real-time packet count graphs
- Protocol distribution pie charts
- Top talkers bar charts
- Alert timeline

## 🧪 Testing

Run unit tests:
```bash
python -m pytest tests/
```

## 🔒 Security Considerations

- **Ethical Use Only**: Use this tool only on networks you own or have permission to monitor
- **Privacy**: Packet sniffing can capture sensitive data. Handle responsibly.
- **Legal Compliance**: Ensure compliance with local laws regarding network monitoring
- **Credentials**: Never commit sensitive credentials to version control

## 🐛 Troubleshooting

### Permission Denied
- Run with sudo/administrator privileges
- Check if user is in the `wireshark` or `pcap` group

### No Packets Captured
- Verify correct network interface name
- Check if interface is up and connected
- Disable firewall temporarily for testing

### Email Alerts Not Working
- Verify SMTP settings
- Enable "Less secure app access" for Gmail
- Use App Passwords for Gmail

## 📝 Interview Questions Preparation

This project covers the following key concepts:
- Network protocols (TCP/IP, UDP, ICMP)
- Socket programming
- Database management
- Anomaly detection algorithms
- Multi-threading
- Security best practices

## 🤝 Contributing

Contributions are welcome! Please follow these steps:
1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 👨‍💻 Author

**Hemant Gaikwad**

## 🙏 Acknowledgments

- Scapy documentation and community
- NetworkX and matplotlib for visualization tools
- SQLite for lightweight database solution
- Python community for excellent libraries

## 📚 References

- [Scapy Official Documentation](https://scapy.readthedocs.io/)
- [RFC 791 - Internet Protocol](https://tools.ietf.org/html/rfc791)
- [RFC 793 - TCP](https://tools.ietf.org/html/rfc793)
- [OWASP Network Security Testing](https://owasp.org/)

## 🔮 Future Enhancements

- [ ] Machine learning-based anomaly detection
- [ ] Support for IPv6 packets
- [ ] Packet reassembly for fragmented packets
- [ ] Protocol-specific deep packet inspection
- [ ] Integration with threat intelligence feeds
- [ ] REST API for remote monitoring
- [ ] Docker containerization
- [ ] Distributed sniffing across multiple nodes

## 📞 Support

For questions or issues, please open an issue on GitHub or contact via email.

---

**⚠️ Disclaimer**: This tool is for educational and authorized testing purposes only. Unauthorized network monitoring is illegal and unethical. Use responsibly.
